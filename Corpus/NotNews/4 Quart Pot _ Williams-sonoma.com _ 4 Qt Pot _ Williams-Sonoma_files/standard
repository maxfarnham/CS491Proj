var mboxCurrent=mboxFactories.get('default').get('ws-global-ticker',0);mboxCurrent.setEventTime('include.start');document.write('<div style="visibility: hidden; display: none" id="mboxImported-default-ws-global-ticker-0">');document.write('<!-- Offer Id: 65678  --><!--\r\nv2\r\nCAMPAIGN: WS Email Capture Overlay - CROSS BRAND OVERLAY\r\nEXPERIENCE: OVERLAY - NO OFFER\r\nOFFER: WS Email Overlay - 10PCT CROSS BRAND OFFER\r\nMBOX: ws-global-ticker\r\n-->\r\n\r\n<script type=\"text\/javascript\">\r\n\twindow.profileMboxName = \'mbox_json_profile_setter_email_ws\';\r\n\twindow.profileSpecifier = \'ws\'; \r\n\t\r\n\twindow.join_email_url = \"https:\/\/secure.williams-sonoma.com\/customer-service\/join-email.jsonp?cm_sp=EmailSignup-_-Overlaytest-_-Submit\";\r\n\twindow.thank_you_img = \"\/\/secure.williams-sonoma.com\/netstorage\/images\/WS_Email_Capture_promo-confirmation.jpg\";\r\n\twindow.cookieDomain + \".williams-sonoma.com\";\r\n\r\n\twindow.service_url = \"\/\/lookup.collectandgather.com\/\";\r\n\twindow.serviceVersion = \"v1\";\r\n\twindow.brand = \"WS\";\r\n\r\n\tdocument.cookie = \"dlgSeen=1; expires=4\/21\/2014; path=\/; domain=\" + WSI.config.cookieSubDomain;\r\n\t\r\n\twindow.addCssToHead = function(cssStr)\r\n\t{\r\n\t\tif(cssStr&&cssStr!=\"\"){\r\n\t\t\tvar headElem=document.getElementsByTagName(\"head\")[0];\r\n\t\t\tif(headElem){\r\n\t\t\t\tvar styleElem=document.createElement(\"style\");\r\n\t\t\t\tstyleElem.setAttribute(\"type\",\"text\/css\");\r\n\t\t\t\tif(styleElem.styleSheet){\r\n\t\t\t\t\tstyleElem.styleSheet.cssText=cssStr\r\n\t\t\t\t}else{\r\n\t\t\t\t\tstyleElem.appendChild(document.createTextNode(cssStr))\r\n\t\t\t\t}\r\n\t\t\t\theadElem.appendChild(styleElem)\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\t\r\n\r\n\tvar cssStr = \'#adEmailPopup {  position: fixed; left: 50%; top: 50%; margin-left: -345px; margin-top: -188px; }\';\r\n        cssStr += \' #adEmailPopup .dialog-container {background: url(\"\/\/secure.williams-sonoma.com\/netstorage\/images\/email-capture-070314.gif\") no-repeat;border: none;height: 301px;width: 695px;} \';\r\n        cssStr += \' #adEmailPopup {z-index:9999 !important;} \';\r\n\tcssStr += \'  #adErrDiv { color:#ab2826; font-family:helvetica;font-size:11px;letter-spacing:0px;padding-bottom:10px;margin-left:120px;text-align:left;width: 100%;} \';\r\n\tcssStr += \' #ad_email_field {border: 1px solid #999999;height: 32px;line-height: 28px;margin: 0;padding: 0 0 0 5px;width: 300px;margin-left:30px} \';\r\n\tcssStr += \' div#adEmailPopup .footer-email-submit {margin-top: 2px;} \';\r\n\tcssStr += \' div#adEmailPopup .footer-email-form, div#adEmailPopup .footer-email-submit {float: left;} \';\r\n\tcssStr += \' div#adEmailPopup .footer-email-form {    margin-left:0px;width:425px;text-align:right;margin-right: 10px;} \';\r\n\tcssStr += \' #modalOverlay{display:none !important;z-index:-100 !important;} \';\r\n\tcssStr += \' .StickyWinInstance{display:none !important;z-index:-100 !important;} \';\r\n\tcssStr += \' .sweep{display:none !important;z-index:-100 !important;} \';\r\n\tcssStr += \' .dijitDialogUnderlayWrapper{display:none !important;z-index:-100 !important;} \';\r\n\tcssStr += \' .dijitDialogUnderlayWrapperAd {background: none repeat scroll 0 0 transparent;display: none;left: 0;position: absolute;top: 0;z-index: 9981;} \';\r\n\tcssStr += \'  #adEmailContent{float-left:65;margin-top:145px;} \';\r\n\tcssStr += \'  #adEmailPopup #ad_email_btn-close{cursor: pointer;height: 30px;width: 30px; float:right; background: url(\"\/\/secure.williams-sonoma.com\/netstorage\/images\/email-capture-x-close_btn-4414.png\") top right; position: relative; top: -12px; left: -5px; \';\r\n\tcssStr += \'  #adEmailPopup div#ad_email_btn-close a.button {height: 4.3em;padding: 1px;width: 79px;float:none;} \';\r\n\tcssStr += \' #adJoinEmail .btn_sign-up{margin-top:0px;margin-left:85px} \';\r\n\twindow.addCssToHead(cssStr);\r\n\r\n<\/script>\r\n\r\n\r\n<script type=\"text\/javascript\">\r\nif(navigator.userAgent.indexOf(\"MSIE\") > -1){\r\n\tvar cssStr2 = \'#adErrDiv{margin-left:8px !important;margin-top:10px !important;font-size:12px !important;width:95% !important;}\';\r\n\tcssStr2 += \'#adErrDiv2{position:absolute;top:10px;left:50px;}\';\r\n\twindow.addCssToHead(cssStr2);\r\n}\r\n<\/script>\r\n\r\n\r\n<div style=\"display:none\">\r\n\t<!-- Preload background images -->\r\n\t<img style=\"display:none\" src=\"\/\/secure.williams-sonoma.com\/netstorage\/images\/email-capture-070314.gif\" \/>\r\n\t<img style=\"display:none\" src=\"\/\/secure.williams-sonoma.com\/netstorage\/images\/WS_Email_Capture_promo-confirmation.jpg\" \/>\r\n\r\n\t<div id=\"adEmailPopup\" class=\"dijitDialog dijitContentPane dialog-default\"  widgetid=\"wsgc_widgets_Dialog_ad\" style=\" display: none;\" title=\"\" role=\"group\">\r\n\t\t<div class=\"dialog-container container-default\" dojoattachpoint=\"containerNode\" id=\"ad_email_dialog-container\">\r\n\t\t\t<div class=\"dialog-title\" style=\"width: auto\">\r\n\t            <div class=\"button-background\" id=\"ad_email_btn-close\" onclick=\"window.adEmailClosePopup(); return false;\">\r\n\t\t\t\t\t<a title=\"Close\" class=\"button\" dojoattachpoint=\"closeButtonNode\" onclick=\"window.adEmailClosePopup(); return false;\" style=\"cursor:pointer;text-indent: 50px;display: inline;\"><\/a>\r\n\r\n\t            <\/div>\r\n\t\t\t<\/div>\r\n\t\t\t<div dojoattachpoint=\"dialogContent\" class=\"dialog-content\" style=\"padding:10px;text-align:center;\">\r\n\t\t\t\t<div id=\"adEmailContent\">\r\n\t\t\t\t<div id=\"adErrDiv\"><\/div>\r\n\t\t\t\t<iframe src=\"about:blank\" style=\"display:none;height: 224px;width: 100%;\" id=\"adEmailFrame\" name=\"adEmailFrame\"><\/iframe>\r\n\t\t\t\t<div class=\"clearfix\" id=\"ad-email-layout\">\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<form id=\"adJoinEmail\" name=\"adJoinEmail\" method=\"post\" onsubmit=\"javascript: return window.adEmailTester.getActivationCode()\" action=\"javascript:void(0)\" class=\"join-email clearfix\">\r\n\t\t\t\t\t\t\t<div class=\"footer-email-form\" style=\"position:relative\">\r\n\t\t\t\t\t\t\t\t<!-- <input type=\"text\" onfocus=\"if (this.value==\'Enter email for sales + new arrivals\') this.value = \'\'\" onblur=\"if (this.value==\'\') this.value = \'Enter email for sales + new arrivals\'\" value=\"Enter email for sales + new arrivals\" style=\"color:#999999;\" size=\"25\" maxlength=\"50\" id=\"ad_email_field\" name=\"ad_email\"> -->\r\n\t\t\t\t\t\t\t\t<span id=\"adErrDiv2\" style=\"display:none;color:black;font-family:helvetica;font-size:12px;letter-spacing:0px;padding-bottom:10px;font-weight:bold;\">Email:<\/span>\r\n\t\t\t\t\t\t\t\t<input type=\"text\"  onfocus=\"if (this.value==\'Enter your email address\') this.value = \'\'; this.style.color = \'#000000\';\" onblur=\"if (this.value==\'\') { this.value = \'Enter your email address\'; this.style.color = \'#999999\';}\" value=\"Enter your email address\" style=\"color:#999999;font-size: 110%;\" size=\"25\" maxlength=\"50\" id=\"ad_email_field\" name=\"ad_email\">\r\n\t\t\t\t\t\t\t<\/div>\r\n\t\t\t\t\t\t\t<div class=\"footer-email-submit\">\r\n\t\t\t\t\t\t\t\t<input type=\"image\" title=\"SIGN UP\" src=\"http:\/\/secure.williams-sonoma.com\/netstorage\/images\/email-capture-sign-up-btn.jpg\" class=\"btn_sign-up\">\r\n\t\t\t\t\t\t\t<\/div>\r\n\t\t\t\t\t\t\t<fieldset class=\"hidden\">\r\n\t\t\t\t\t\t\t\t<input type=\"text\" value=\"EmailSignup-_-Overlaytest-_-Submit\" maxlength=\"50\" id=\"cm-field\" name=\"cm_sp\">\r\n\t\t\t\t\t\t\t<\/fieldset>\r\n\t\t\t\t\t\t<\/form>\r\n\t\t\t\t\t<\/div>\r\n\t\t\t\t<\/div>\r\n\t\t\t\t<\/div>\r\n\t\t\t<\/div>\r\n\t\t<\/div>\r\n\t<\/div>\r\n\t<div class=\"dijitDialogUnderlayWrapperAd\" widgetid=\"dijit_DialogUnderlay_ad\" id=\"adEmailPopupBG\"  style=\'background-color: #fff; top: 0px; left: 0px; opacity:1;display:none;-ms-filter: \"progid:DXImageTransform.Microsoft.Alpha(Opacity=50)\";filter: alpha(opacity=50);-khtml-opacity: 0.5;-moz-opacity: 0.5;opacity: 0.5;\' onclick=\"window.adEmailClosePopup(); return false;\">\r\n\t\t<div id=\"adEmailPopupBGVis\"  dojoattachpoint=\"node\" class=\"dijitDialogUnderlay\" ><\/div>\r\n\t<\/div>\r\n<\/div>\r\n\r\n<script type=\"text\/javascript\">\r\n\r\n        function mboxTrack(mbox) { var d = new Date(); var ub = mboxFactoryDefault.getUrlBuilder().clone(); ub.addParameter(\"mbox\", mbox); ub.addParameter(\'mboxTime\', d.getTime() - (d.getTimezoneOffset() * 60000)); ub.addParameters(Array.prototype.slice.call(arguments).slice(1)); var img = new Image(); img.src = ub.buildUrl().replace(\"\/mbox\/undefined\", \"\/mbox\/ajax\"); img.style.display = \"none\"; if (document.body) document.body.insertBefore(img,document.body.firstChild); } \r\n\r\n        function tntAddEvent(elem, eventName, func) { if (elem) { if (elem.addEventListener) elem.addEventListener(eventName, func, true); else if (elem.attachEvent) elem.attachEvent(\"on\" + eventName, func); else elem[\"on\" + eventName] = func; } };\r\n\r\n        window.fireEvent = function(element,eventName) { if (document.createEventObject) { \/* dispatch for IE *\/ var event = document.createEventObject(); if (eventName.toLowerCase().substr(0,2)!=\"on\") eventName = \"on\" + eventName; element.fireEvent(eventName,event); } else { \/* dispatch for firefox + others *\/ var event = document.createEvent(\"MouseEvents\"); if (eventName.toLowerCase().substr(0,2)==\"on\") eventName = eventName.substr(2); event.initMouseEvent(eventName, true, true, document.defaultView, 0, 100, 0, 0, 0, false, false, false, false, 0, null); element.dispatchEvent(event); } };\r\n\r\n\ttntGetCheckParams = function(toCheck) {\r\n\t\t   var params = [];\r\n                   var checkboxes = document.getElementsByName(\"emailMeBean.catalogs\");\r\n\t\t   for (var i=0, chkbox; chkbox=checkboxes[i], i<toCheck.length; i++) {\r\n   \t\t       var parentClass = (chkbox ? chkbox.parentNode.className || \"\" : \"\");\r\n   \t\t       for (var j=0, item; item=toCheck[j], j<toCheck.length; j++) {\t\t           \r\n\t\t           if (item.selector==parentClass) {\r\n\t\t               params.push(item.paramName + \"=\" + chkbox.checked);\r\n\t\t           }\r\n\t\t       }\r\n\t\t   }\r\n                   var elem = document.getElementById(\"catalogSignUpCheck\");\r\n                   if (elem);\r\n                        params.push(\"catSignUp=\" + elem.checked);\r\n\t\t   return params;\r\n\t}\r\n\r\n        window.tntLookForSubmit2 = function() {\r\n\t    var elem = document.getElementById(\"submit\");\r\n\t    if (elem) {\r\n\t        tntAddEvent(elem, \"mousedown\", function() {\r\n\t\t       var params = tntGetCheckParams([\r\n\t       \t            { selector: \"ws\", paramName: \"chkWestElm\" },\r\n\t\t            { selector: \"pb\", paramName: \"chkPotteryBarn\" },\r\n\t       \t            { selector: \"pk\", paramName: \"chkPotteryBarnKids\" },\r\n\t\t            { selector: \"mg\", paramName: \"chkMarkAndGraham\" },\r\n\t       \t            { selector: \"catalogSignUpCheck\", paramName: \"catSignUp\" }\r\n\t       \t   ]);   \r\n\t       \t   params.splice(0,0,window.profileMboxName,\"clicked=submit2\")\r\n\t       \t   mboxUpdate.apply({},params);\r\n\t       \t});\r\n\t    } else {\r\n                setTimeout(\"tntLookForSubmit2()\",500);\r\n            }\r\n        } \/\/ function tntLookForSubmit2\r\n\r\n\twindow.adEmailSetSessionCookie = function()\r\n\t{\r\n\t\tif( document.cookie.indexOf(\'ad_sess_wsi_email\') < 0){\r\n\t\t\t\r\n\t\t\tvar thisDate = new Date();\r\n\t\t\tthisDate.setDate(thisDate.getDate() + 14);\r\n\t\t\tmboxUpdate(window.profileMboxName, \"profile.nextWSIEmailPop=\" + thisDate + \"\");\r\n\t\t\tdocument.cookie = \"ad_sess_wsi_email=true; expires=\" + thisDate + \"; path=\/\";\r\n\t\t\treturn false;\r\n\t\t}else{\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\r\n\twindow.adSwizEmailBG = function(){\r\n\t\tvar adCtr = 0;\r\n\t\tvar d = document.getElementsByTagName(\'div\');\r\n\t\tfor(var i=0;i<d.length;i++){\r\n\t\t\tif(d[i].id && d[i].id == \"adEmailPopupBG\"){\r\n\t\t\t\tadCtr++;\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor(var i=0;i<d.length;i++){\r\n\t\t\tif(d[i].className && d[i].className == \'dijitDialogUnderlayWrapper\'){ d[i].parentNode.removeChild(d[i]); i--; }\r\n\t\t}\r\n\t\tif(adCtr == 1){\r\n\t\t\tvar p = document.getElementById(\'adEmailPopupBG\');\r\n\t\t\tp.style.display=\"block\";\r\n\t\t\tdocument.getElementById(\'adEmailPopupBGVis\').style.width = (window.getPageSize().pageWidth) + \'px\';\r\n\t\t\tdocument.getElementById(\'adEmailPopupBGVis\').style.height = (window.getPageSize().pageHeight) + \'px\';\r\n\t\t\tdocument.body.insertBefore(p, document.body.firstChild)\r\n\t\t}\r\n\t}\r\n\r\n\twindow.adSwizEmailPop = function(){\r\n\t\tvar adCtr = 0;\r\n\t\tvar d = document.getElementsByTagName(\'div\');\r\n\t\tfor(var i=0;i<d.length;i++){\r\n\t\t\tif(d[i].id && d[i].id == \"adEmailPopup\"){\r\n\t\t\t\tadCtr++;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(adCtr == 1){\r\n\t\t\tvar p = document.getElementById(\'adEmailPopup\');\r\n\t\t\t\tp.style.display=\"block\";\r\n\t\t\tdocument.body.insertBefore(p, document.body.firstChild)\r\n\t\t}\r\n\t}\r\n\r\n\twindow.adEmailPopup = function()\r\n\t{\r\n\t\tvar p;\r\n\t\tvar pbg;\r\n\t\r\n\t\tvar d = document.getElementsByTagName(\'div\');\r\n\t\tfor(var i=0;i<d.length;i++){\r\n\t\r\n\t\t\tif(d[i].id && d[i].id == \"adEmailPopup\"){\r\n\t\t\t\tp = d[i];\r\n\t\t\t\td[i].style.display = \"block\";\r\n\t\t\t}\r\n\t\t\tif(d[i].id && d[i].id == \"adEmailPopupBG\"){\r\n\t\t\t\tpbg = d[i];\r\n\t\t\t\td[i].style.display = \"block\";\r\n\t\t\t}\r\n\t\t}\r\n\t\r\n\t\tif(p && pbg){ \r\n\t\t\tp.style.display = \"block\"; \r\n\t\t\tpbg.style.display = \"block\"; \r\n\t\t\tdocument.getElementById(\'adEmailPopupBGVis\').style.width = (window.getPageSize().pageWidth) + \'px\';\r\n\t\t\tdocument.getElementById(\'adEmailPopupBGVis\').style.height = (window.getPageSize().pageHeight) + \'px\';\r\n\t\t}\r\n\t}\r\n\r\n\twindow.adEmailClosePopup = function()\r\n\t{\r\n\t\tvar p;\r\n\t\tvar pbg;\r\n\r\n\t\tvar d = document.getElementsByTagName(\'div\');\r\n\t\tfor(var i=0;i<d.length;i++){\r\n\r\n\t\t\tif(d[i].id && d[i].id == \"adEmailPopup\"){\r\n\t\t\t\tp = d[i];\r\n\t\t\t\td[i].style.display = \"none\";\r\n\t\t\t}\r\n\t\t\tif(d[i].id && d[i].id == \"adEmailPopupBG\"){\r\n\t\t\t\tpbg = d[i];\r\n\t\t\t\td[i].style.display = \"none\";\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(p && pbg){ p.style.display = \"none\"; pbg.style.display = \"none\";}\r\n\t\tmboxUpdate(window.profileMboxName, \'clicked=closePopup\');\r\n\t\r\n\t}\r\n\r\n\twindow.getPageSize = function() {\r\n\t\t\r\n\t\tvar isIE;\r\n\t\tif(navigator.appName.indexOf(\'Internet Explorer\') > -1){\r\n\t\t\tisIE = true;\r\n\t\t}else{\r\n\t\t\tisIE = false;\r\n\t\t}\r\n        var e = document,\r\n        i = window,\r\n\r\n        k = e.compatMode && e.compatMode != \"BackCompat\" ? e.documentElement: e.body;\r\n        var g = e.body;\r\n        var l = (i.innerWidth && i.scrollMaxX) ? i.innerWidth + i.scrollMaxX: Math.max(g.scrollWidth, g.offsetWidth),\r\n        f = (i.innerHeight && window.scrollMaxY) ? i.innerHeight + i.scrollMaxY: Math.max(g.scrollHeight, g.offsetHeight),\r\n        h = isIE ? k.scrollWidth: (e.documentElement.clientWidth || self.innerWidth),\r\n        c = isIE ? Math.max(k.scrollHeight, k.clientHeight) : (e.documentElement.clientHeight || self.innerHeight);\r\n        var a = isIE ? k.clientWidth: (e.documentElement.clientWidth || self.innerWidth),\r\n        j = isIE ? k.clientHeight: self.innerHeight;\r\n        return {\r\n            pageWidth: Math.max(h, l),\r\n            pageHeight: Math.max(c, f),\r\n            width: a,\r\n            height: j,\r\n            scrollLeft: isIE ? k.scrollLeft: pageXOffset,\r\n            scrollTop: isIE ? k.scrollTop: pageYOffset\r\n        }\r\n    }\r\n\r\n\twindow.adEmailCheckTestParam = function()\r\n\t{\r\n\t\tif(location.search.indexOf(\"fid=\") > -1){\r\n\t\t\tvar s = location.search.split(\"&\");\r\n\t\t\tfor(var i=0;i<s.length;i++){\r\n\t\t\t\tif(s[i].indexOf(\"fid=\") > -1){\r\n\t\t\t\t\treturn s[i].split(\"=\")[1];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn \"\";\r\n\t}\r\n\r\n\twindow.adDisplayEmailOverlay = function()\r\n\t{\r\n\t\twindow.adSwizEmailBG();\r\n\t\twindow.adSwizEmailPop();\r\n\t}\r\n\r\n\twindow.adEmailTester = new (function() {\r\n\t\tvar service_url =  window.service_url;\r\n\t\t\r\n\t\tvar temp = new Array();\r\n\t\tvar adParams = new Array();\r\n\t\tvar theCookies = document.cookie;\r\n\r\n\t\tthis.addScriptTag = function(requestUrl) {\r\n\r\n\t        var script = document.createElement(\'script\');\r\n\t        script.src = requestUrl;\r\n\t        document.body.insertBefore(script,document.body.firstChild);\r\n\t    }\r\n\r\n\t    this.lookupHandler = function(retObj) {        \r\n\r\n\t        var idVal = retObj; \r\n\t\t\tif(idVal){\r\n\t\t\t\tvar a = idVal.split(\"|\");\r\n\t\t\t\tfor(var i=0;i<a.length;i++){\r\n\t\t\t\t\tvar b = a[i].split(\'=\');\r\n\t\t\t\t\tif(b.length > 1){\r\n\t\t\t\t\t\tif(b[0] == \"return_code\"){\r\n\t\t\t\t\t\t\tadParams.splice(0, 0, \"profile.return_code_emailList_\" + window.profileSpecifier + \"=\" + b[1]);\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tadParams.splice(0, 0, \"profile.\" + window.profileSpecifier + \"_\" + b[0] + \"=\" + b[1]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}else if(a[i].indexOf(\'NO MATCH\') > -1){\r\n\t\t\t\t\t\tadParams.splice(0, 0, \"profile.return_code_emailList_\" + window.profileSpecifier + \"=NO MATCH\");\r\n\t\t\t\t\t\twindow.adDisplayEmailOverlay();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tadEmailSetSessionCookie();\r\n\t\t\t\t\r\n\t\t\t\tif(adParams.length > 0){\r\n\t\t\t\t\tadParams.splice(0, 0, \"profile.the_id_reset_\" + window.profileSpecifier +  \"=true\");\r\n\t\t\t\t\tadParams.splice(0, 0, window.profileMboxName);\r\n\t\t\t\t\tmboxUpdate.apply(this, adParams);\r\n\t\t\t\t}else{\r\n\t\t\t\t\tadParams.splice(0, 0, \"profile.return_code_emailList_\" + window.profileSpecifier + \"=\");\r\n\t\t\t\t\tadParams.splice(0, 0, window.profileMboxName);\r\n\t\t\t\t\tmboxUpdate.apply(this, adParams);\r\n\t\t\t\t\twindow.adDisplayDefault();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t    }\r\n\t\r\n\t\tthis.setEmailCodeHandler = function(retObj) {        \r\n\t\t\tadParams = new Array();\r\n\t        var idVal = retObj; \r\n\t\t\tif(idVal){\r\n\t\t\t\tvar a = idVal.split(\"|\");\r\n\t\t\t\tfor(var i=0;i<a.length;i++){\r\n\t\t\t\t\tvar b = a[i].split(\'=\');\r\n\t\t\t\t\tif(b.length > 1){\r\n\t\t\t\t\t\tif(b[0] == \"email_return_code\"){\r\n\t\t\t\t\t\t\tadParams.splice(0, 0, \"profile.return_code_emailList_\" + window.profileSpecifier + \"=\" + b[1]);\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tadParams.splice(0, 0, \"profile.\" + window.profileSpecifier + \"_\" + b[0] + \"=\" + b[1]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}else if(a[i].indexOf(\'NO MATCH\') > -1){\r\n\t\t\t\t\t\tadParams.splice(0, 0, \"profile.return_code_emailList_\" + window.profileSpecifier + \"=NO MATCH\");\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif(adParams.length > 0){\r\n\t\t\t\t\tadParams.splice(0, 0, window.profileMboxName);\r\n\t\t\t\t\tmboxUpdate.apply(this, adParams);\r\n\t\t\t\t}else{\r\n\t\t\t\t\tadParams.splice(0, 0, window.profileMboxName);\r\n\t\t\t\t\tmboxUpdate.apply(this, adParams);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tsetTimeout(function(){ \r\n\t\t\t\t\tvar fr = document.getElementById(\'adEmailFrame\');\r\n\t\t\t\t\tvar f = document.getElementById(\'adJoinEmail\');\r\n\t\t\t\t\tvar c = document.getElementById(\'adEmailContent\');\t\t\t\t\t\r\n\t\t\t\t\tif(fr && f && c){\r\n\t\t\t\t\t\tfr.src = join_email_url + \"&email=\" + encodeURIComponent(f.ad_email.value);\r\n\t\t\t\t\t\tc.style.display = \"none\";\r\n\t\t\t\t\t\tfr.parentNode.style.height = \"225px\";\r\n\t\t\t\t\t\tmboxUpdate(window.profileMboxName, \'clicked=thankYouForm\');\r\n\t\t\t\t\t\tadEmailHideFrameClose();\r\n\t\t\t\t\t} \r\n\t\t\t\t}, \r\n\t\t\t1000);\r\n\r\n\t    }\r\n\t\r\n\t\tthis.getActivationCode = function() {\r\n\t\t\tvar e = document.getElementById(\'adErrDiv\');\t\t  \t\t  \r\n\t\t\tvar f = document.getElementById(\'adJoinEmail\');\r\n                        var popEmailTxt = document.getElementById(\"ad_email_field\");\r\n\r\n                        var btmForm = document.getElementById(\"joinEmail\");\r\n\t\t\tvar btmEmailTxt= (btmForm ? btmForm.getElementsByTagName(\"input\")[0] : null);\r\n\t\t\tvar btmEmailBtn = (btmForm ? btmForm.getElementsByTagName(\"input\")[1] : null);\r\n\t\t\tmboxUpdate(window.profileMboxName, \'clicked=emailFormSubmit\');\r\n\t\t\t\r\n\t\t\tif(e){ e.innerHTML = \"\"; }\r\n\t\t\tif(e && f && f.ad_email && this.validateEmail(f.ad_email.value)){\r\n\t\t\t\tif (btmEmailTxt && btmEmailBtn && popEmailTxt) {\r\n\t\t\t\t    btmEmailTxt.value = popEmailTxt.value;\t\t\t\t\r\n\t\t\t\t    fireEvent(btmEmailBtn,\"click\");\r\n\t\t\t\t    adEmailClosePopup();\r\n\t\t\t\t    this.addScriptTag(service_url + \"email-opt-in-service\/\" + window.serviceVersion + \"\/\" + window.brand + \"\/\" + encodeURIComponent(f.ad_email.value) + \"?callBack=window.adEmailTester.setEmailCodeHandler\" + \"\");\r\n\t\t\t  \t}\r\n\t\t                tntLookForSubmit2();\r\n\t\t\t}else{\r\n\t\t\t\te.innerHTML = \"<p style=\'color:black !important;margin-left:-5px;\'>*Required Information<\/p><p>Please enter an email address as &#34jdoe@email.com.&#34 The email address can be up to 75 characters long.<\/p>\"\r\n\t\t\t\tvar e2 = document.getElementById(\'adErrDiv2\');\r\n\t\t\t\tif(e2){e2.style.color=\"#ab2826\";}\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t\t\r\n\t\tthis.validateEmail = function(_value) {\t\t  \t\t  \r\n\t\t\tvar emailPattern = \/^[a-zA-Z0-9._%+`!#$%^&*()-=:;\\\"\\\'\\<\\>?]+@(([A-Za-z0-9\\-]+)\\.)+([A-Za-z0-9]{2,4})$\/;  \r\n\t\t\tif(!emailPattern.test(_value) || _value.length > 75){\r\n\t\t\t\treturn false;\r\n\t\t\t}else{\r\n\t\t\t\treturn true;\r\n\t\t\t}\t\t\t\r\n\t\t}\r\n\r\n\t\tthis.lookup = function() {\r\n\t\t\tvar p = adEmailCheckTestParam();\r\n\t\t\tvar campaign_url = service_url + \"campaign-service\/\" + window.serviceVersion + \"\/\" + window.brand + \"\/\" + \"EmailSuppress\/\"\r\n\t\t\tif(p == \'\'){\r\n\t\t\t\ttemp = theCookies.split(\";\");\r\n\t\t\t\tfor(var x=0;x<temp.length;x++){\r\n\t\t\t\t\tif(temp[x].indexOf(\"CoreID6\")> -1){\r\n\t\t\t\t\t\tvar coreID6 = temp[x].split(\"=\");\r\n\t\t\t\t\t\tvar coreID6cookie = coreID6[1];\r\n\t\t\t\t\t\tif(coreID6cookie != \"\"){\t\r\n\t\t\t\t\t\t\tthis.addScriptTag(campaign_url + coreID6cookie + \"?callBack=window.adEmailTester.lookupHandler\");\r\n\t\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\/\/We want to do the popup if there is no core cookie - new user\r\n\t\t\t\tif(theCookies.indexOf(\"CoreID6\") == -1){\r\n\t\t\t\t\tthis.addScriptTag(campaign_url + \"12345\" + \"?callBack=window.adEmailTester.lookupHandler\");\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t}\r\n\t\t\t\twindow.adDisplayDefault();\r\n\t\t\t}else{\r\n\t\t\t\tthis.addScriptTag(campaign_url + p + \"?callBack=window.adEmailTester.lookupHandler\");\r\n\t\t\t}\r\n\t\t}\r\n\t} )\/\/ adEmailTester\r\n\r\n\twindow.adEmailHideFrameClose = function()\r\n\t{\r\n\t\t\tbFound = false;\r\n\t\t\t\/\/if(window.frames[\"adEmailFrame\"] && window.frames[\"adEmailFrame\"].location.href.indexOf(\"\/customer-service\/join-email.html?\") > -1){\r\n\t\t\t\ttry{\r\n\t\t\t\t\tif(window.frames[\"adEmailFrame\"] && window.frames[\"adEmailFrame\"].src != \"\" && window.frames[\"adEmailFrame\"].document){\r\n\t\t\t\t\t\t\/\/if(window.frames[\"adEmailFrame\"].document.getElementById(\'content\')){\r\n\t\t\t\t\t\t\tvar d = document.getElementById(\'ad_email_dialog-container\');\r\n\t\t\t\t\t\t\tif(d){d.style.backgroundImage = \"url(\'\" + window.thank_you_img + \"\')\"; bFound=true  }\r\n\t\t\t\t\t\t\/\/}\r\n\t\t\t\t\t}\r\n\t\t\t\t}catch(e){}\r\n\t\t\t\/\/}\r\n\t\t\tif(!bFound){ setTimeout(\"window.adEmailHideFrameClose()\", 100);}\r\n\r\n\t}\r\n\r\n\t\r\n\twindow.adCreateCookie = function(name,value,days) {\r\n\t\tdocument.cookie = name+\"=\"+value+expires+\"; path=\/\";\r\n\t}\r\n\r\n\twindow.adEmailSetSessionCookie = function()\r\n\t{\r\n\t\tif( document.cookie.indexOf(\'ad_sess_wsi_email\') < 0){\r\n\t\t\t\r\n\t\t\tvar thisDate = new Date();\r\n\t\t\tthisDate.setDate(thisDate.getDate() + 14)\r\n\r\n\t\t\tdocument.cookie = \"ad_sess_wsi_email=true; expires=\" + thisDate + \"; path=\/\";\r\n\t\t\treturn false;\r\n\t\t}else{\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\r\n\r\n\twindow.adEmailCheckSessionCookie = function()\r\n\t{\r\n\t\tif( document.cookie.indexOf(\'ad_sess_wsi_email\') < 0){\r\n\t\t\treturn false;\r\n\t\t}else{\r\n\t\t\treturn true;\r\n\t\t}\r\n\t}\r\n\r\n\tif(typeof(mbox) != \"undefined\" && !document.getElementById(\'adJSONEmailDiv\')){\r\n\t        var d = document.createElement(\'div\');\r\n\t        d.id = \"adJSONEmailDiv\";\r\n\t        document.body.insertBefore(d,document.body.firstChild);\r\n\t        mboxDefine(\'adJSONEmailDiv\',window.profileMboxName).setFetcher(new mboxAjaxFetcher());\r\n\t}\r\n\r\n\t\/\/----------------------------------------------------------------------\r\n\t\r\n\twindow.adSmartMboxDefine = function(_mbox){\r\n\t\tif(typeof(mbox) != \"undefined\" && !document.getElementById(_mbox + \'_div\')){\r\n\t\t        var d = document.createElement(\'div\');\r\n\t\t        d.id = _mbox + \'_div\';\r\n\t\t        document.body.insertBefore(d,document.body.firstChild);\r\n\t\t        mboxDefine(_mbox + \'_div\', _mbox).setFetcher(new mboxAjaxFetcher());\r\n\t\t}\r\n\t}\r\n\twindow.adAddEmailTracking = function()\r\n\t{\r\n\t\tvar f = document.getElementById(\'joinEmail\');\r\n\t\tif(f){\r\n\t\t\tvar a = f.getElementsByTagName(\'input\');\r\n\t\t\tfor(var i=0;i<a.length;i++){\r\n\t\t\t\tif(a[i].className && a[i].className == \"btn_sign-up\"){\r\n\t\t\t\t\ta[i].onmousedown = function(){ adSmartMboxDefine(\'mboxClickTrack\');mboxUpdate(\'mboxClickTrack\', \'clicked=footerSubmit\'); }\r\n\t\t\t\t\ta[i].setAttribute(\'addig\', \'handled\');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}else{\r\n\t\t\tsetTimeout(\"window.adAddEmailTracking()\", 100);\r\n\t\t}\r\n\t}\r\n\t\r\n\tmboxFactoryDefault.addOnLoad( function(){\r\n\t\tif(!adEmailCheckSessionCookie() || window.location.href.indexOf(\"&forcePop\") > -1){\r\n\t\t\twindow.adEmailTester.lookup();\r\n\t\t}\r\n\t\twindow.adAddEmailTracking();\r\n\t\tif(typeof(dojo) != \"undefined\"){\r\n\t\t\tdojo.publish(\"\/closeDialogs\");\r\n\r\n\r\n\t\t}\r\n\t})\r\n\r\n<\/script>');document.write('<!-- Offer Id: 32674  --><script type=\"text\/javascript\">\r\n\/*mboxHighlight+ (1of2) v1 ==> Response Plugin*\/\r\nwindow.ttMETA=(typeof(window.ttMETA)!=\'undefined\')?window.ttMETA:[];window.ttMETA.push({\'mbox\':\'ws-global-ticker\',\'campaign\':\'WS Email Capture Overlay - CROSS BRAND OVERLAY\',\'experience\':\'OVERLAY - NO OFFER\',\'offer\':\'WS Email Overlay - 10PCT CROSS BRAND OFFER\'});window.ttMBX=function(x){var mbxList=[];for(i=0;i<ttMETA.length;i++){if(ttMETA[i].mbox==x.getName()){mbxList.push(ttMETA[i])}}return mbxList[x.getId()]}\r\n<\/script>');document.write('</div>');mboxCurrent.setEventTime('include.end');mboxFactories.get('default').get('ws-global-ticker',0).loaded();mboxFactories.get('default').getPCId().forceId("1430371103023-893254.28_40");